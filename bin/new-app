#!/bin/sh
dir=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
app="$dir/.."
template=$dir/../vendor/Dev-Lucid/Lucid/template

echo "Making directories"
mkdir $app/database;
mkdir $app/database/patches;
mkdir $app/database/models;
mkdir $app/config;
mkdir $app/cache;
mkdir $app/dictionaries;
mkdir $app/app;
mkdir $app/app/controllers;
mkdir $app/app/views;
mkdir $app/app/media;
mkdir $app/app/media/js;
mkdir $app/app/media/images;
mkdir $app/app/media/less;
mkdir $app/app/media/less/fonts;

echo "Coping app files"
cp $template/config/*.php $app/config/
cp $template/app/*.php $app/app/
cp $template/database/build* $app/database/
cp $template/database/models/* $app/database/models/
cp $template/app/views/*.php $app/app/views/
cp $template/app/controllers/*.php $app/app/controllers/

echo "Installing libraries"
cp $template/composer.json $app
cd $app;
rm composer.lock
composer install

echo "Retrieving recommended jquery version (1.11.1)"
curl "https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" > jquery.min.js
mv jquery.min.js $app/app/media/js/;

echo "Building basic database"
cd $app/database/;
sqlite3 development.sqlite ".read build.sqlite.sql"

echo "-----------------------"
echo "App complete. to run this app, bin/launch $1;"
